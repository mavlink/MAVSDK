// WARNING: THIS FILE IS AUTOGENERATED! As such, it should not be edited.
// Edits need to be made to the proto files
// (see https://github.com/mavlink/MAVSDK-Proto/blob/main/protos/ftp/ftp.proto)

#ifndef CMAVSDK_FTP_H
#define CMAVSDK_FTP_H

#include <stddef.h>
#include <stdint.h>
#include <stdbool.h>
#include "cmavsdk/mavsdk_export.h"

#ifdef __cplusplus
extern "C" {
#endif

/**
 * @brief Implements file transfer functionality using MAVLink FTP.
 */

// ===== Forward Declarations =====
typedef struct mavsdk_system_s *mavsdk_system_t;

// ===== Opaque Handles =====
typedef struct mavsdk_ftp_s *mavsdk_ftp_t;
typedef struct mavsdk_ftp_download_handle_s *mavsdk_ftp_download_handle_t;
typedef struct mavsdk_ftp_upload_handle_s *mavsdk_ftp_upload_handle_t;

// ===== Enums =====

// ===== Structs =====
/**
 * @brief The output of a directory list
 *
 * @note This struct may contain dynamically allocated memory. Always call
 *       mavsdk_ftp_list_directory_data_destroy() when done to avoid memory leaks.
 */
typedef struct CMAVSDK_EXPORT {
    /**  The found directories. */
    char** dirs;
    size_t dirs_size;
    /**  The found files. */
    char** files;
    size_t files_size;
} mavsdk_ftp_list_directory_data_t;

/**
 * @brief Destroy a list_directory_data struct.
 *
 * Frees all memory allocated by MAVSDK for this struct, including any
 * dynamically allocated arrays or strings. Must be called to avoid memory leaks.
 * Always call this function when done with the struct, even if it currently
 * contains no dynamic allocations.
 *
 * @param target Pointer to the struct to destroy. Can be NULL (no-op).
 */
CMAVSDK_EXPORT void mavsdk_ftp_list_directory_data_destroy(
    mavsdk_ftp_list_directory_data_t* target);

/**
 * @brief Destroy an array of list_directory_data structs.
 *
 * Frees all memory allocated for the array and its elements, including any
 * nested dynamic allocations. Must be called to avoid memory leaks.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 * @param size Number of elements in the array.
 */
CMAVSDK_EXPORT void mavsdk_ftp_list_directory_data_array_destroy(
    mavsdk_ftp_list_directory_data_t** array,
    size_t size);

/**
 * @brief Progress data type for file transfer.
 *
 * @note This struct may contain dynamically allocated memory. Always call
 *       mavsdk_ftp_progress_data_destroy() when done to avoid memory leaks.
 */
typedef struct CMAVSDK_EXPORT {
    /**  The number of bytes already transferred. */
    uint32_t bytes_transferred;
    /**  The total bytes to transfer. */
    uint32_t total_bytes;
} mavsdk_ftp_progress_data_t;

/**
 * @brief Destroy a progress_data struct.
 *
 * Frees all memory allocated by MAVSDK for this struct, including any
 * dynamically allocated arrays or strings. Must be called to avoid memory leaks.
 * Always call this function when done with the struct, even if it currently
 * contains no dynamic allocations.
 *
 * @param target Pointer to the struct to destroy. Can be NULL (no-op).
 */
CMAVSDK_EXPORT void mavsdk_ftp_progress_data_destroy(
    mavsdk_ftp_progress_data_t* target);

/**
 * @brief Destroy an array of progress_data structs.
 *
 * Frees all memory allocated for the array and its elements, including any
 * nested dynamic allocations. Must be called to avoid memory leaks.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 * @param size Number of elements in the array.
 */
CMAVSDK_EXPORT void mavsdk_ftp_progress_data_array_destroy(
    mavsdk_ftp_progress_data_t** array,
    size_t size);

/**
 * @brief Possible results returned for FTP commands
 */
typedef enum {
    /**  Unknown result. */
    MAVSDK_FTP_RESULT_UNKNOWN = 0,
    /**  Success. */
    MAVSDK_FTP_RESULT_SUCCESS = 1,
    /**  Intermediate message showing progress. */
    MAVSDK_FTP_RESULT_NEXT = 2,
    /**  Timeout. */
    MAVSDK_FTP_RESULT_TIMEOUT = 3,
    /**  Operation is already in progress. */
    MAVSDK_FTP_RESULT_BUSY = 4,
    /**  File IO operation error. */
    MAVSDK_FTP_RESULT_FILE_IO_ERROR = 5,
    /**  File exists already. */
    MAVSDK_FTP_RESULT_FILE_EXISTS = 6,
    /**  File does not exist. */
    MAVSDK_FTP_RESULT_FILE_DOES_NOT_EXIST = 7,
    /**  File is write protected. */
    MAVSDK_FTP_RESULT_FILE_PROTECTED = 8,
    /**  Invalid parameter. */
    MAVSDK_FTP_RESULT_INVALID_PARAMETER = 9,
    /**  Unsupported command. */
    MAVSDK_FTP_RESULT_UNSUPPORTED = 10,
    /**  General protocol error. */
    MAVSDK_FTP_RESULT_PROTOCOL_ERROR = 11,
    /**  No system connected. */
    MAVSDK_FTP_RESULT_NO_SYSTEM = 12,
} mavsdk_ftp_result_t;



// ===== Primitive Array Destroy Functions =====
/**
 * @brief Destroy an array of float.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_ftp_float_array_destroy(float** array);
/**
 * @brief Destroy an array of double.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_ftp_double_array_destroy(double** array);
/**
 * @brief Destroy an array of int32_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_ftp_int32t_array_destroy(int32_t** array);
/**
 * @brief Destroy an array of uint32_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_ftp_uint32t_array_destroy(uint32_t** array);
/**
 * @brief Destroy an array of int64_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_ftp_int64t_array_destroy(int64_t** array);
/**
 * @brief Destroy an array of uint64_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_ftp_uint64t_array_destroy(uint64_t** array);
/**
 * @brief Destroy an array of bool.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_ftp_bool_array_destroy(bool** array);

/**
 * @brief Destroy a string (char*).
 *
 * Frees the memory allocated for the string.
 *
 * @param str Pointer to the string pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_ftp_string_destroy(char** str);

/**
 * @brief Destroy a byte buffer (uint8_t*).
 *
 * Frees the memory allocated for the byte buffer.
 *
 * @param buffer Pointer to the buffer pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_ftp_byte_buffer_destroy(uint8_t** buffer);

// ===== Callback Typedefs =====
typedef void (*mavsdk_ftp_download_callback_t)(const mavsdk_ftp_result_t result, const mavsdk_ftp_progress_data_t progress_data, void* user_data);
typedef void (*mavsdk_ftp_upload_callback_t)(const mavsdk_ftp_result_t result, const mavsdk_ftp_progress_data_t progress_data, void* user_data);
typedef void (*mavsdk_ftp_list_directory_callback_t)(const mavsdk_ftp_result_t result, const mavsdk_ftp_list_directory_data_t data, void* user_data);
typedef void (*mavsdk_ftp_create_directory_callback_t)(const mavsdk_ftp_result_t result, void* user_data);
typedef void (*mavsdk_ftp_remove_directory_callback_t)(const mavsdk_ftp_result_t result, void* user_data);
typedef void (*mavsdk_ftp_remove_file_callback_t)(const mavsdk_ftp_result_t result, void* user_data);
typedef void (*mavsdk_ftp_rename_callback_t)(const mavsdk_ftp_result_t result, void* user_data);
typedef void (*mavsdk_ftp_are_files_identical_callback_t)(const mavsdk_ftp_result_t result, const bool are_identical, void* user_data);

// ===== Ftp Creation/Destruction =====
CMAVSDK_EXPORT mavsdk_ftp_t mavsdk_ftp_create(mavsdk_system_t system);
CMAVSDK_EXPORT void mavsdk_ftp_destroy(mavsdk_ftp_t ftp);

// ===== Methods =====

/**
 * @brief Downloads a file to local directory.
 *
 * @param ftp The ftp instance.
* @param remote_file_path  The path of the remote file to download.
 * 
* @param local_dir  The local directory to download to.
 * 
* @param use_burst  Use burst for faster downloading.
 * 
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 */
CMAVSDK_EXPORT void mavsdk_ftp_download_async(
    mavsdk_ftp_t ftp,
    char* remote_file_path,
    char* local_dir,
    bool use_burst,
    mavsdk_ftp_download_callback_t callback,
    void* user_data);



/**
 * @brief Uploads local file to remote directory.
 *
 * @param ftp The ftp instance.
* @param local_file_path  The local file path to upload.
 * 
* @param remote_dir  The remote directory to upload to.
 * 
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 */
CMAVSDK_EXPORT void mavsdk_ftp_upload_async(
    mavsdk_ftp_t ftp,
    char* local_file_path,
    char* remote_dir,
    mavsdk_ftp_upload_callback_t callback,
    void* user_data);



/**
 * @brief Lists items from a remote directory.
 *
 * @param ftp The ftp instance.
* @param remote_dir  The remote directory to list the contents for.
 * 
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 */
CMAVSDK_EXPORT void mavsdk_ftp_list_directory_async(
    mavsdk_ftp_t ftp,
    char* remote_dir,
    mavsdk_ftp_list_directory_callback_t callback,
    void* user_data);


/**
 * @brief Get the current list directory (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param list_directory_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_ftp_result_t
mavsdk_ftp_list_directory(
    mavsdk_ftp_t ftp,
    char* remote_dir,
    mavsdk_ftp_list_directory_data_t* data_out);


/**
 * @brief Creates a remote directory.
 *
 * @param ftp The ftp instance.
* @param remote_dir  The remote directory to create.
 * 
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 */
CMAVSDK_EXPORT void mavsdk_ftp_create_directory_async(
    mavsdk_ftp_t ftp,
    char* remote_dir,
    mavsdk_ftp_create_directory_callback_t callback,
    void* user_data);


/**
 * @brief Get the current create directory (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param create_directory_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_ftp_result_t
mavsdk_ftp_create_directory(
    mavsdk_ftp_t ftp,
    char* remote_dir);


/**
 * @brief Removes a remote directory.
 *
 * @param ftp The ftp instance.
* @param remote_dir  The remote directory to remove.
 * 
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 */
CMAVSDK_EXPORT void mavsdk_ftp_remove_directory_async(
    mavsdk_ftp_t ftp,
    char* remote_dir,
    mavsdk_ftp_remove_directory_callback_t callback,
    void* user_data);


/**
 * @brief Get the current remove directory (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param remove_directory_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_ftp_result_t
mavsdk_ftp_remove_directory(
    mavsdk_ftp_t ftp,
    char* remote_dir);


/**
 * @brief Removes a remote file.
 *
 * @param ftp The ftp instance.
* @param remote_file_path  The path of the remote file to remove.
 * 
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 */
CMAVSDK_EXPORT void mavsdk_ftp_remove_file_async(
    mavsdk_ftp_t ftp,
    char* remote_file_path,
    mavsdk_ftp_remove_file_callback_t callback,
    void* user_data);


/**
 * @brief Get the current remove file (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param remove_file_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_ftp_result_t
mavsdk_ftp_remove_file(
    mavsdk_ftp_t ftp,
    char* remote_file_path);


/**
 * @brief Renames a remote file or remote directory.
 *
 * @param ftp The ftp instance.
* @param remote_from_path  The remote source path.
 * 
* @param remote_to_path  The remote destination path.
 * 
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 */
CMAVSDK_EXPORT void mavsdk_ftp_rename_async(
    mavsdk_ftp_t ftp,
    char* remote_from_path,
    char* remote_to_path,
    mavsdk_ftp_rename_callback_t callback,
    void* user_data);


/**
 * @brief Get the current rename (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param rename_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_ftp_result_t
mavsdk_ftp_rename(
    mavsdk_ftp_t ftp,
    char* remote_from_path,
    char* remote_to_path);


/**
 * @brief Compares a local file to a remote file using a CRC32 checksum.
 *
 * @param ftp The ftp instance.
* @param local_file_path  The path of the local file.
 * 
* @param remote_file_path  The path of the remote file.
 * 
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 */
CMAVSDK_EXPORT void mavsdk_ftp_are_files_identical_async(
    mavsdk_ftp_t ftp,
    char* local_file_path,
    char* remote_file_path,
    mavsdk_ftp_are_files_identical_callback_t callback,
    void* user_data);


/**
 * @brief Get the current are files identical (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param are_files_identical_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_ftp_result_t
mavsdk_ftp_are_files_identical(
    mavsdk_ftp_t ftp,
    char* local_file_path,
    char* remote_file_path,
    bool* are_identical_out);


/**
 * @brief Get the current set target compid (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param set_target_compid_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_ftp_result_t
mavsdk_ftp_set_target_compid(
    mavsdk_ftp_t ftp,
    uint32_t compid);


#ifdef __cplusplus
}
#endif

#endif // CMAVSDK_FTP_H
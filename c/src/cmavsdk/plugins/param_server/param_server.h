// WARNING: THIS FILE IS AUTOGENERATED! As such, it should not be edited.
// Edits need to be made to the proto files
// (see https://github.com/mavlink/MAVSDK-Proto/blob/main/protos/param_server/param_server.proto)

#ifndef CMAVSDK_PARAM_SERVER_H
#define CMAVSDK_PARAM_SERVER_H

#include <stddef.h>
#include <stdint.h>
#include <stdbool.h>
#include "cmavsdk/mavsdk_export.h"

#ifdef __cplusplus
extern "C" {
#endif

/**
 * @brief Provide raw access to retrieve and provide server parameters.
 */

// ===== Forward Declarations =====
typedef struct mavsdk_server_component_s *mavsdk_server_component_t;

// ===== Opaque Handles =====
typedef struct mavsdk_param_server_s *mavsdk_param_server_t;
typedef struct mavsdk_param_server_changed_param_int_handle_s *mavsdk_param_server_changed_param_int_handle_t;
typedef struct mavsdk_param_server_changed_param_float_handle_s *mavsdk_param_server_changed_param_float_handle_t;
typedef struct mavsdk_param_server_changed_param_custom_handle_s *mavsdk_param_server_changed_param_custom_handle_t;

// ===== Enums =====

// ===== Structs =====
/**
 * @brief Type for integer parameters.
 *
 * @note This struct may contain dynamically allocated memory. Always call
 *       mavsdk_param_server_int_param_destroy() when done to avoid memory leaks.
 */
typedef struct CMAVSDK_EXPORT {
    /**  Name of the parameter */
    char* name;
    /**  Value of the parameter */
    int32_t value;
} mavsdk_param_server_int_param_t;

/**
 * @brief Destroy a int_param struct.
 *
 * Frees all memory allocated by MAVSDK for this struct, including any
 * dynamically allocated arrays or strings. Must be called to avoid memory leaks.
 * Always call this function when done with the struct, even if it currently
 * contains no dynamic allocations.
 *
 * @param target Pointer to the struct to destroy. Can be NULL (no-op).
 */
CMAVSDK_EXPORT void mavsdk_param_server_int_param_destroy(
    mavsdk_param_server_int_param_t* target);

/**
 * @brief Destroy an array of int_param structs.
 *
 * Frees all memory allocated for the array and its elements, including any
 * nested dynamic allocations. Must be called to avoid memory leaks.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 * @param size Number of elements in the array.
 */
CMAVSDK_EXPORT void mavsdk_param_server_int_param_array_destroy(
    mavsdk_param_server_int_param_t** array,
    size_t size);

/**
 * @brief Type for float parameters.
 *
 * @note This struct may contain dynamically allocated memory. Always call
 *       mavsdk_param_server_float_param_destroy() when done to avoid memory leaks.
 */
typedef struct CMAVSDK_EXPORT {
    /**  Name of the parameter */
    char* name;
    /**  Value of the parameter */
    float value;
} mavsdk_param_server_float_param_t;

/**
 * @brief Destroy a float_param struct.
 *
 * Frees all memory allocated by MAVSDK for this struct, including any
 * dynamically allocated arrays or strings. Must be called to avoid memory leaks.
 * Always call this function when done with the struct, even if it currently
 * contains no dynamic allocations.
 *
 * @param target Pointer to the struct to destroy. Can be NULL (no-op).
 */
CMAVSDK_EXPORT void mavsdk_param_server_float_param_destroy(
    mavsdk_param_server_float_param_t* target);

/**
 * @brief Destroy an array of float_param structs.
 *
 * Frees all memory allocated for the array and its elements, including any
 * nested dynamic allocations. Must be called to avoid memory leaks.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 * @param size Number of elements in the array.
 */
CMAVSDK_EXPORT void mavsdk_param_server_float_param_array_destroy(
    mavsdk_param_server_float_param_t** array,
    size_t size);

/**
 * @brief Type for float parameters.
 *
 * @note This struct may contain dynamically allocated memory. Always call
 *       mavsdk_param_server_custom_param_destroy() when done to avoid memory leaks.
 */
typedef struct CMAVSDK_EXPORT {
    /**  Name of the parameter */
    char* name;
    /**  Value of the parameter */
    char* value;
} mavsdk_param_server_custom_param_t;

/**
 * @brief Destroy a custom_param struct.
 *
 * Frees all memory allocated by MAVSDK for this struct, including any
 * dynamically allocated arrays or strings. Must be called to avoid memory leaks.
 * Always call this function when done with the struct, even if it currently
 * contains no dynamic allocations.
 *
 * @param target Pointer to the struct to destroy. Can be NULL (no-op).
 */
CMAVSDK_EXPORT void mavsdk_param_server_custom_param_destroy(
    mavsdk_param_server_custom_param_t* target);

/**
 * @brief Destroy an array of custom_param structs.
 *
 * Frees all memory allocated for the array and its elements, including any
 * nested dynamic allocations. Must be called to avoid memory leaks.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 * @param size Number of elements in the array.
 */
CMAVSDK_EXPORT void mavsdk_param_server_custom_param_array_destroy(
    mavsdk_param_server_custom_param_t** array,
    size_t size);

/**
 * @brief Type collecting all integer, float, and custom parameters.
 *
 * @note This struct may contain dynamically allocated memory. Always call
 *       mavsdk_param_server_all_params_destroy() when done to avoid memory leaks.
 */
typedef struct CMAVSDK_EXPORT {
    /**  Collection of all parameter names and values of type int */
    mavsdk_param_server_int_param_t* int_params;
    size_t int_params_size;
    /**  Collection of all parameter names and values of type float */
    mavsdk_param_server_float_param_t* float_params;
    size_t float_params_size;
    /**  Collection of all parameter names and values of type custom */
    mavsdk_param_server_custom_param_t* custom_params;
    size_t custom_params_size;
} mavsdk_param_server_all_params_t;

/**
 * @brief Destroy a all_params struct.
 *
 * Frees all memory allocated by MAVSDK for this struct, including any
 * dynamically allocated arrays or strings. Must be called to avoid memory leaks.
 * Always call this function when done with the struct, even if it currently
 * contains no dynamic allocations.
 *
 * @param target Pointer to the struct to destroy. Can be NULL (no-op).
 */
CMAVSDK_EXPORT void mavsdk_param_server_all_params_destroy(
    mavsdk_param_server_all_params_t* target);

/**
 * @brief Destroy an array of all_params structs.
 *
 * Frees all memory allocated for the array and its elements, including any
 * nested dynamic allocations. Must be called to avoid memory leaks.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 * @param size Number of elements in the array.
 */
CMAVSDK_EXPORT void mavsdk_param_server_all_params_array_destroy(
    mavsdk_param_server_all_params_t** array,
    size_t size);

/**
 * @brief Possible results returned for param requests.
 */
typedef enum {
    /**  Unknown result. */
    MAVSDK_PARAM_SERVER_RESULT_UNKNOWN = 0,
    /**  Request succeeded. */
    MAVSDK_PARAM_SERVER_RESULT_SUCCESS = 1,
    /**  Not Found. */
    MAVSDK_PARAM_SERVER_RESULT_NOT_FOUND = 2,
    /**  Wrong type. */
    MAVSDK_PARAM_SERVER_RESULT_WRONG_TYPE = 3,
    /**  Parameter name too long (> 16). */
    MAVSDK_PARAM_SERVER_RESULT_PARAM_NAME_TOO_LONG = 4,
    /**  No system available. */
    MAVSDK_PARAM_SERVER_RESULT_NO_SYSTEM = 5,
    /**  Parameter name too long (> 128). */
    MAVSDK_PARAM_SERVER_RESULT_PARAM_VALUE_TOO_LONG = 6,
    /**  All parameters have to be provided upfront. */
    MAVSDK_PARAM_SERVER_RESULT_PARAM_PROVIDED_TOO_LATE = 7,
} mavsdk_param_server_result_t;



// ===== Primitive Array Destroy Functions =====
/**
 * @brief Destroy an array of float.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_param_server_float_array_destroy(float** array);
/**
 * @brief Destroy an array of double.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_param_server_double_array_destroy(double** array);
/**
 * @brief Destroy an array of int32_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_param_server_int32t_array_destroy(int32_t** array);
/**
 * @brief Destroy an array of uint32_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_param_server_uint32t_array_destroy(uint32_t** array);
/**
 * @brief Destroy an array of int64_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_param_server_int64t_array_destroy(int64_t** array);
/**
 * @brief Destroy an array of uint64_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_param_server_uint64t_array_destroy(uint64_t** array);
/**
 * @brief Destroy an array of bool.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_param_server_bool_array_destroy(bool** array);

/**
 * @brief Destroy a string (char*).
 *
 * Frees the memory allocated for the string.
 *
 * @param str Pointer to the string pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_param_server_string_destroy(char** str);

/**
 * @brief Destroy a byte buffer (uint8_t*).
 *
 * Frees the memory allocated for the byte buffer.
 *
 * @param buffer Pointer to the buffer pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_param_server_byte_buffer_destroy(uint8_t** buffer);

// ===== Callback Typedefs =====
typedef void (*mavsdk_param_server_changed_param_int_callback_t)(const mavsdk_param_server_int_param_t param, void* user_data);
typedef void (*mavsdk_param_server_changed_param_float_callback_t)(const mavsdk_param_server_float_param_t param, void* user_data);
typedef void (*mavsdk_param_server_changed_param_custom_callback_t)(const mavsdk_param_server_custom_param_t param, void* user_data);

// ===== ParamServer Creation/Destruction =====
CMAVSDK_EXPORT mavsdk_param_server_t mavsdk_param_server_create(mavsdk_server_component_t server_component);
CMAVSDK_EXPORT void mavsdk_param_server_destroy(mavsdk_param_server_t param_server);

// ===== Methods =====

/**
 * @brief Get the current set protocol (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param set_protocol_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_param_server_result_t
mavsdk_param_server_set_protocol(
    mavsdk_param_server_t param_server,
    bool extended_protocol);


/**
 * @brief Get the current retrieve param int (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param retrieve_param_int_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_param_server_result_t
mavsdk_param_server_retrieve_param_int(
    mavsdk_param_server_t param_server,
    char* name,
    int32_t* value_out);


/**
 * @brief Get the current provide param int (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param provide_param_int_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_param_server_result_t
mavsdk_param_server_provide_param_int(
    mavsdk_param_server_t param_server,
    char* name,
    int32_t value);


/**
 * @brief Get the current retrieve param float (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param retrieve_param_float_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_param_server_result_t
mavsdk_param_server_retrieve_param_float(
    mavsdk_param_server_t param_server,
    char* name,
    float* value_out);


/**
 * @brief Get the current provide param float (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param provide_param_float_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_param_server_result_t
mavsdk_param_server_provide_param_float(
    mavsdk_param_server_t param_server,
    char* name,
    float value);


/**
 * @brief Get the current retrieve param custom (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param retrieve_param_custom_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_param_server_result_t
mavsdk_param_server_retrieve_param_custom(
    mavsdk_param_server_t param_server,
    char* name,
    char** value_out);


/**
 * @brief Get the current provide param custom (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param provide_param_custom_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_param_server_result_t
mavsdk_param_server_provide_param_custom(
    mavsdk_param_server_t param_server,
    char* name,
    char* value);


/**
 * @brief Get the current retrieve all params (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param retrieve_all_params_out Pointer to store the result.
 */
CMAVSDK_EXPORT
void
mavsdk_param_server_retrieve_all_params(
    mavsdk_param_server_t param_server,
    mavsdk_param_server_all_params_t* params_out);


/**
 * @brief Subscribe to changed int param.
 *
 * @param param_server The param_server instance.
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 * @return Handle for this subscription. Use mavsdk_param_server_unsubscribe_changed_param_int() to unsubscribe.
 */
CMAVSDK_EXPORT mavsdk_param_server_changed_param_int_handle_t mavsdk_param_server_subscribe_changed_param_int(
    mavsdk_param_server_t param_server,
    mavsdk_param_server_changed_param_int_callback_t callback,
    void* user_data);

/**
 * @brief Unsubscribe from 'changed_param_int' updates.
 *
 * Stops the subscription and frees resources associated with the handle.
 *
 * @param param_server The param_server instance.
 * @param handle The subscription handle returned by mavsdk_param_server_subscribe_changed_param_int().
 */
CMAVSDK_EXPORT void mavsdk_param_server_unsubscribe_changed_param_int(
    mavsdk_param_server_t param_server,
    mavsdk_param_server_changed_param_int_handle_t);


/**
 * @brief Subscribe to changed float param.
 *
 * @param param_server The param_server instance.
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 * @return Handle for this subscription. Use mavsdk_param_server_unsubscribe_changed_param_float() to unsubscribe.
 */
CMAVSDK_EXPORT mavsdk_param_server_changed_param_float_handle_t mavsdk_param_server_subscribe_changed_param_float(
    mavsdk_param_server_t param_server,
    mavsdk_param_server_changed_param_float_callback_t callback,
    void* user_data);

/**
 * @brief Unsubscribe from 'changed_param_float' updates.
 *
 * Stops the subscription and frees resources associated with the handle.
 *
 * @param param_server The param_server instance.
 * @param handle The subscription handle returned by mavsdk_param_server_subscribe_changed_param_float().
 */
CMAVSDK_EXPORT void mavsdk_param_server_unsubscribe_changed_param_float(
    mavsdk_param_server_t param_server,
    mavsdk_param_server_changed_param_float_handle_t);


/**
 * @brief Subscribe to changed custom param.
 *
 * @param param_server The param_server instance.
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 * @return Handle for this subscription. Use mavsdk_param_server_unsubscribe_changed_param_custom() to unsubscribe.
 */
CMAVSDK_EXPORT mavsdk_param_server_changed_param_custom_handle_t mavsdk_param_server_subscribe_changed_param_custom(
    mavsdk_param_server_t param_server,
    mavsdk_param_server_changed_param_custom_callback_t callback,
    void* user_data);

/**
 * @brief Unsubscribe from 'changed_param_custom' updates.
 *
 * Stops the subscription and frees resources associated with the handle.
 *
 * @param param_server The param_server instance.
 * @param handle The subscription handle returned by mavsdk_param_server_subscribe_changed_param_custom().
 */
CMAVSDK_EXPORT void mavsdk_param_server_unsubscribe_changed_param_custom(
    mavsdk_param_server_t param_server,
    mavsdk_param_server_changed_param_custom_handle_t);


#ifdef __cplusplus
}
#endif

#endif // CMAVSDK_PARAM_SERVER_H
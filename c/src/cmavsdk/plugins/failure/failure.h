// WARNING: THIS FILE IS AUTOGENERATED! As such, it should not be edited.
// Edits need to be made to the proto files
// (see https://github.com/mavlink/MAVSDK-Proto/blob/main/protos/failure/failure.proto)

#ifndef CMAVSDK_FAILURE_H
#define CMAVSDK_FAILURE_H

#include <stddef.h>
#include <stdint.h>
#include <stdbool.h>
#include "cmavsdk/mavsdk_export.h"

#ifdef __cplusplus
extern "C" {
#endif

/**
 * @brief Inject failures into system to test failsafes.
 */

// ===== Forward Declarations =====
typedef struct mavsdk_system_s *mavsdk_system_t;

// ===== Opaque Handles =====
typedef struct mavsdk_failure_s *mavsdk_failure_t;

// ===== Enums =====
/**
 * @brief A failure unit.
 */
typedef enum {
    /**  Gyro. */
    MAVSDK_FAILURE_FAILURE_UNIT_SENSOR_GYRO = 0,
    /**  Accelerometer. */
    MAVSDK_FAILURE_FAILURE_UNIT_SENSOR_ACCEL = 1,
    /**  Magnetometer. */
    MAVSDK_FAILURE_FAILURE_UNIT_SENSOR_MAG = 2,
    /**  Barometer. */
    MAVSDK_FAILURE_FAILURE_UNIT_SENSOR_BARO = 3,
    /**  GPS. */
    MAVSDK_FAILURE_FAILURE_UNIT_SENSOR_GPS = 4,
    /**  Optical flow. */
    MAVSDK_FAILURE_FAILURE_UNIT_SENSOR_OPTICAL_FLOW = 5,
    /**  Visual inertial odometry. */
    MAVSDK_FAILURE_FAILURE_UNIT_SENSOR_VIO = 6,
    /**  Distance sensor. */
    MAVSDK_FAILURE_FAILURE_UNIT_SENSOR_DISTANCE_SENSOR = 7,
    /**  Airspeed. */
    MAVSDK_FAILURE_FAILURE_UNIT_SENSOR_AIRSPEED = 8,
    /**  Battery. */
    MAVSDK_FAILURE_FAILURE_UNIT_SYSTEM_BATTERY = 9,
    /**  Motor. */
    MAVSDK_FAILURE_FAILURE_UNIT_SYSTEM_MOTOR = 10,
    /**  Servo. */
    MAVSDK_FAILURE_FAILURE_UNIT_SYSTEM_SERVO = 11,
    /**  Avoidance. */
    MAVSDK_FAILURE_FAILURE_UNIT_SYSTEM_AVOIDANCE = 12,
    /**  RC signal. */
    MAVSDK_FAILURE_FAILURE_UNIT_SYSTEM_RC_SIGNAL = 13,
    /**  MAVLink signal. */
    MAVSDK_FAILURE_FAILURE_UNIT_SYSTEM_MAVLINK_SIGNAL = 14,
} mavsdk_failure_failure_unit_t;

/**
 * @brief A failure type
 */
typedef enum {
    /**  No failure injected, used to reset a previous failure. */
    MAVSDK_FAILURE_FAILURE_TYPE_OK = 0,
    /**  Sets unit off, so completely non-responsive. */
    MAVSDK_FAILURE_FAILURE_TYPE_OFF = 1,
    /**  Unit is stuck e.g. keeps reporting the same value. */
    MAVSDK_FAILURE_FAILURE_TYPE_STUCK = 2,
    /**  Unit is reporting complete garbage. */
    MAVSDK_FAILURE_FAILURE_TYPE_GARBAGE = 3,
    /**  Unit is consistently wrong. */
    MAVSDK_FAILURE_FAILURE_TYPE_WRONG = 4,
    /**  Unit is slow, so e.g. reporting at slower than expected rate. */
    MAVSDK_FAILURE_FAILURE_TYPE_SLOW = 5,
    /**  Data of unit is delayed in time. */
    MAVSDK_FAILURE_FAILURE_TYPE_DELAYED = 6,
    /**  Unit is sometimes working, sometimes not. */
    MAVSDK_FAILURE_FAILURE_TYPE_INTERMITTENT = 7,
} mavsdk_failure_failure_type_t;


// ===== Structs =====
/**
 * @brief Possible results returned for failure requests.
 */
typedef enum {
    /**  Unknown result. */
    MAVSDK_FAILURE_RESULT_UNKNOWN = 0,
    /**  Request succeeded. */
    MAVSDK_FAILURE_RESULT_SUCCESS = 1,
    /**  No system is connected. */
    MAVSDK_FAILURE_RESULT_NO_SYSTEM = 2,
    /**  Connection error. */
    MAVSDK_FAILURE_RESULT_CONNECTION_ERROR = 3,
    /**  Failure not supported. */
    MAVSDK_FAILURE_RESULT_UNSUPPORTED = 4,
    /**  Failure injection denied. */
    MAVSDK_FAILURE_RESULT_DENIED = 5,
    /**  Failure injection is disabled. */
    MAVSDK_FAILURE_RESULT_DISABLED = 6,
    /**  Request timed out. */
    MAVSDK_FAILURE_RESULT_TIMEOUT = 7,
} mavsdk_failure_result_t;



// ===== Primitive Array Destroy Functions =====
/**
 * @brief Destroy an array of float.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_failure_float_array_destroy(float** array);
/**
 * @brief Destroy an array of double.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_failure_double_array_destroy(double** array);
/**
 * @brief Destroy an array of int32_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_failure_int32t_array_destroy(int32_t** array);
/**
 * @brief Destroy an array of uint32_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_failure_uint32t_array_destroy(uint32_t** array);
/**
 * @brief Destroy an array of int64_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_failure_int64t_array_destroy(int64_t** array);
/**
 * @brief Destroy an array of uint64_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_failure_uint64t_array_destroy(uint64_t** array);
/**
 * @brief Destroy an array of bool.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_failure_bool_array_destroy(bool** array);

/**
 * @brief Destroy a string (char*).
 *
 * Frees the memory allocated for the string.
 *
 * @param str Pointer to the string pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_failure_string_destroy(char** str);

/**
 * @brief Destroy a byte buffer (uint8_t*).
 *
 * Frees the memory allocated for the byte buffer.
 *
 * @param buffer Pointer to the buffer pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_failure_byte_buffer_destroy(uint8_t** buffer);

// ===== Callback Typedefs =====

// ===== Failure Creation/Destruction =====
CMAVSDK_EXPORT mavsdk_failure_t mavsdk_failure_create(mavsdk_system_t system);
CMAVSDK_EXPORT void mavsdk_failure_destroy(mavsdk_failure_t failure);

// ===== Methods =====

/**
 * @brief Get the current inject (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param inject_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_failure_result_t
mavsdk_failure_inject(
    mavsdk_failure_t failure,
    mavsdk_failure_failure_unit_t failure_unit,
    mavsdk_failure_failure_type_t failure_type,
    int32_t instance);


#ifdef __cplusplus
}
#endif

#endif // CMAVSDK_FAILURE_H
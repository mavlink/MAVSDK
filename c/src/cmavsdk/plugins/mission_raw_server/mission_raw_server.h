// WARNING: THIS FILE IS AUTOGENERATED! As such, it should not be edited.
// Edits need to be made to the proto files
// (see https://github.com/mavlink/MAVSDK-Proto/blob/main/protos/mission_raw_server/mission_raw_server.proto)

#ifndef CMAVSDK_MISSION_RAW_SERVER_H
#define CMAVSDK_MISSION_RAW_SERVER_H

#include <stddef.h>
#include <stdint.h>
#include <stdbool.h>
#include "cmavsdk/mavsdk_export.h"

#ifdef __cplusplus
extern "C" {
#endif

/**
 * @brief Acts as a vehicle and receives incoming missions from GCS (in raw MAVLINK format). 
 * Provides current mission item state, so the server can progress through missions.
 */

// ===== Forward Declarations =====
typedef struct mavsdk_server_component_s *mavsdk_server_component_t;

// ===== Opaque Handles =====
typedef struct mavsdk_mission_raw_server_s *mavsdk_mission_raw_server_t;
typedef struct mavsdk_mission_raw_server_incoming_mission_handle_s *mavsdk_mission_raw_server_incoming_mission_handle_t;
typedef struct mavsdk_mission_raw_server_current_item_changed_handle_s *mavsdk_mission_raw_server_current_item_changed_handle_t;
typedef struct mavsdk_mission_raw_server_clear_all_handle_s *mavsdk_mission_raw_server_clear_all_handle_t;

// ===== Enums =====

// ===== Structs =====
/**
 * @brief Mission item exactly identical to MAVLink MISSION_ITEM_INT.
 *
 * @note This struct may contain dynamically allocated memory. Always call
 *       mavsdk_mission_raw_server_mission_item_destroy() when done to avoid memory leaks.
 */
typedef struct CMAVSDK_EXPORT {
    /**  Sequence (uint16_t) */
    uint32_t seq;
    /**  The coordinate system of the waypoint (actually uint8_t) */
    uint32_t frame;
    /**  The scheduled action for the waypoint (actually uint16_t) */
    uint32_t command;
    /**  false:0, true:1 (actually uint8_t) */
    uint32_t current;
    /**  Autocontinue to next waypoint (actually uint8_t) */
    uint32_t autocontinue;
    /**  PARAM1, see MAV_CMD enum */
    float param1;
    /**  PARAM2, see MAV_CMD enum */
    float param2;
    /**  PARAM3, see MAV_CMD enum */
    float param3;
    /**  PARAM4, see MAV_CMD enum */
    float param4;
    /**  PARAM5 / local: x position in meters * 1e4, global: latitude in degrees * 10^7 */
    int32_t x;
    /**  PARAM6 / y position: local: x position in meters * 1e4, global: longitude in degrees *10^7 */
    int32_t y;
    /**  PARAM7 / local: Z coordinate, global: altitude (relative or absolute, depending on frame) */
    float z;
    /**  Mission type (actually uint8_t) */
    uint32_t mission_type;
} mavsdk_mission_raw_server_mission_item_t;

/**
 * @brief Destroy a mission_item struct.
 *
 * Frees all memory allocated by MAVSDK for this struct, including any
 * dynamically allocated arrays or strings. Must be called to avoid memory leaks.
 * Always call this function when done with the struct, even if it currently
 * contains no dynamic allocations.
 *
 * @param target Pointer to the struct to destroy. Can be NULL (no-op).
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_mission_item_destroy(
    mavsdk_mission_raw_server_mission_item_t* target);

/**
 * @brief Destroy an array of mission_item structs.
 *
 * Frees all memory allocated for the array and its elements, including any
 * nested dynamic allocations. Must be called to avoid memory leaks.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 * @param size Number of elements in the array.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_mission_item_array_destroy(
    mavsdk_mission_raw_server_mission_item_t** array,
    size_t size);

/**
 * @brief Mission plan type
 *
 * @note This struct may contain dynamically allocated memory. Always call
 *       mavsdk_mission_raw_server_mission_plan_destroy() when done to avoid memory leaks.
 */
typedef struct CMAVSDK_EXPORT {
    /**  The mission items */
    mavsdk_mission_raw_server_mission_item_t* mission_items;
    size_t mission_items_size;
} mavsdk_mission_raw_server_mission_plan_t;

/**
 * @brief Destroy a mission_plan struct.
 *
 * Frees all memory allocated by MAVSDK for this struct, including any
 * dynamically allocated arrays or strings. Must be called to avoid memory leaks.
 * Always call this function when done with the struct, even if it currently
 * contains no dynamic allocations.
 *
 * @param target Pointer to the struct to destroy. Can be NULL (no-op).
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_mission_plan_destroy(
    mavsdk_mission_raw_server_mission_plan_t* target);

/**
 * @brief Destroy an array of mission_plan structs.
 *
 * Frees all memory allocated for the array and its elements, including any
 * nested dynamic allocations. Must be called to avoid memory leaks.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 * @param size Number of elements in the array.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_mission_plan_array_destroy(
    mavsdk_mission_raw_server_mission_plan_t** array,
    size_t size);

/**
 * @brief Mission progress type.
 *
 * @note This struct may contain dynamically allocated memory. Always call
 *       mavsdk_mission_raw_server_mission_progress_destroy() when done to avoid memory leaks.
 */
typedef struct CMAVSDK_EXPORT {
    /**  Current mission item index (0-based), if equal to total, the mission is finished */
    int32_t current;
    /**  Total number of mission items */
    int32_t total;
} mavsdk_mission_raw_server_mission_progress_t;

/**
 * @brief Destroy a mission_progress struct.
 *
 * Frees all memory allocated by MAVSDK for this struct, including any
 * dynamically allocated arrays or strings. Must be called to avoid memory leaks.
 * Always call this function when done with the struct, even if it currently
 * contains no dynamic allocations.
 *
 * @param target Pointer to the struct to destroy. Can be NULL (no-op).
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_mission_progress_destroy(
    mavsdk_mission_raw_server_mission_progress_t* target);

/**
 * @brief Destroy an array of mission_progress structs.
 *
 * Frees all memory allocated for the array and its elements, including any
 * nested dynamic allocations. Must be called to avoid memory leaks.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 * @param size Number of elements in the array.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_mission_progress_array_destroy(
    mavsdk_mission_raw_server_mission_progress_t** array,
    size_t size);

/**
 * @brief Possible results returned for action requests.
 */
typedef enum {
    /**  Unknown result. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_UNKNOWN = 0,
    /**  Request succeeded. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_SUCCESS = 1,
    /**  Error. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_ERROR = 2,
    /**  Too many mission items in the mission. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_TOO_MANY_MISSION_ITEMS = 3,
    /**  Vehicle is busy. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_BUSY = 4,
    /**  Request timed out. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_TIMEOUT = 5,
    /**  Invalid argument. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_INVALID_ARGUMENT = 6,
    /**  Mission downloaded from the system is not supported. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_UNSUPPORTED = 7,
    /**  No mission available on the system. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_NO_MISSION_AVAILABLE = 8,
    /**  Unsupported mission command. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_UNSUPPORTED_MISSION_CMD = 9,
    /**  Mission transfer (upload or download) has been cancelled. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_TRANSFER_CANCELLED = 10,
    /**  No system connected. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_NO_SYSTEM = 11,
    /**  Intermediate message showing progress or instructions on the next steps. */
    MAVSDK_MISSION_RAW_SERVER_RESULT_NEXT = 12,
} mavsdk_mission_raw_server_result_t;



// ===== Primitive Array Destroy Functions =====
/**
 * @brief Destroy an array of float.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_float_array_destroy(float** array);
/**
 * @brief Destroy an array of double.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_double_array_destroy(double** array);
/**
 * @brief Destroy an array of int32_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_int32t_array_destroy(int32_t** array);
/**
 * @brief Destroy an array of uint32_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_uint32t_array_destroy(uint32_t** array);
/**
 * @brief Destroy an array of int64_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_int64t_array_destroy(int64_t** array);
/**
 * @brief Destroy an array of uint64_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_uint64t_array_destroy(uint64_t** array);
/**
 * @brief Destroy an array of bool.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_bool_array_destroy(bool** array);

/**
 * @brief Destroy a string (char*).
 *
 * Frees the memory allocated for the string.
 *
 * @param str Pointer to the string pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_string_destroy(char** str);

/**
 * @brief Destroy a byte buffer (uint8_t*).
 *
 * Frees the memory allocated for the byte buffer.
 *
 * @param buffer Pointer to the buffer pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_byte_buffer_destroy(uint8_t** buffer);

// ===== Callback Typedefs =====
typedef void (*mavsdk_mission_raw_server_incoming_mission_callback_t)(const mavsdk_mission_raw_server_result_t result, const mavsdk_mission_raw_server_mission_plan_t mission_plan, void* user_data);
typedef void (*mavsdk_mission_raw_server_current_item_changed_callback_t)(const mavsdk_mission_raw_server_mission_item_t mission_item, void* user_data);
typedef void (*mavsdk_mission_raw_server_clear_all_callback_t)(const uint32_t clear_type, void* user_data);

// ===== MissionRawServer Creation/Destruction =====
CMAVSDK_EXPORT mavsdk_mission_raw_server_t mavsdk_mission_raw_server_create(mavsdk_server_component_t server_component);
CMAVSDK_EXPORT void mavsdk_mission_raw_server_destroy(mavsdk_mission_raw_server_t mission_raw_server);

// ===== Methods =====

/**
 * @brief Subscribe to when a new mission is uploaded (asynchronous).
 *
 * @param mission_raw_server The mission_raw_server instance.
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 * @return Handle for this subscription. Use mavsdk_mission_raw_server_unsubscribe_incoming_mission() to unsubscribe.
 */
CMAVSDK_EXPORT mavsdk_mission_raw_server_incoming_mission_handle_t mavsdk_mission_raw_server_subscribe_incoming_mission(
    mavsdk_mission_raw_server_t mission_raw_server,
    mavsdk_mission_raw_server_incoming_mission_callback_t callback,
    void* user_data);

/**
 * @brief Unsubscribe from 'incoming_mission' updates.
 *
 * Stops the subscription and frees resources associated with the handle.
 *
 * @param mission_raw_server The mission_raw_server instance.
 * @param handle The subscription handle returned by mavsdk_mission_raw_server_subscribe_incoming_mission().
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_unsubscribe_incoming_mission(
    mavsdk_mission_raw_server_t mission_raw_server,
    mavsdk_mission_raw_server_incoming_mission_handle_t);


/**
 * @brief Subscribe to when a new current item is set
 *
 * @param mission_raw_server The mission_raw_server instance.
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 * @return Handle for this subscription. Use mavsdk_mission_raw_server_unsubscribe_current_item_changed() to unsubscribe.
 */
CMAVSDK_EXPORT mavsdk_mission_raw_server_current_item_changed_handle_t mavsdk_mission_raw_server_subscribe_current_item_changed(
    mavsdk_mission_raw_server_t mission_raw_server,
    mavsdk_mission_raw_server_current_item_changed_callback_t callback,
    void* user_data);

/**
 * @brief Unsubscribe from 'current_item_changed' updates.
 *
 * Stops the subscription and frees resources associated with the handle.
 *
 * @param mission_raw_server The mission_raw_server instance.
 * @param handle The subscription handle returned by mavsdk_mission_raw_server_subscribe_current_item_changed().
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_unsubscribe_current_item_changed(
    mavsdk_mission_raw_server_t mission_raw_server,
    mavsdk_mission_raw_server_current_item_changed_handle_t);


/**
 * @brief Get the current set current item complete (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param set_current_item_complete_out Pointer to store the result.
 */
CMAVSDK_EXPORT
void
mavsdk_mission_raw_server_set_current_item_complete(
    mavsdk_mission_raw_server_t mission_raw_server);


/**
 * @brief Subscribe when a MISSION_CLEAR_ALL is received
 *
 * @param mission_raw_server The mission_raw_server instance.
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 * @return Handle for this subscription. Use mavsdk_mission_raw_server_unsubscribe_clear_all() to unsubscribe.
 */
CMAVSDK_EXPORT mavsdk_mission_raw_server_clear_all_handle_t mavsdk_mission_raw_server_subscribe_clear_all(
    mavsdk_mission_raw_server_t mission_raw_server,
    mavsdk_mission_raw_server_clear_all_callback_t callback,
    void* user_data);

/**
 * @brief Unsubscribe from 'clear_all' updates.
 *
 * Stops the subscription and frees resources associated with the handle.
 *
 * @param mission_raw_server The mission_raw_server instance.
 * @param handle The subscription handle returned by mavsdk_mission_raw_server_subscribe_clear_all().
 */
CMAVSDK_EXPORT void mavsdk_mission_raw_server_unsubscribe_clear_all(
    mavsdk_mission_raw_server_t mission_raw_server,
    mavsdk_mission_raw_server_clear_all_handle_t);


#ifdef __cplusplus
}
#endif

#endif // CMAVSDK_MISSION_RAW_SERVER_H
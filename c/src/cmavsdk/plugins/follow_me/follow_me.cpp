// WARNING: THIS FILE IS AUTOGENERATED! As such, it should not be edited.
// Edits need to be made to the proto files
// (see https://github.com/mavlink/MAVSDK-Proto/blob/main/protos/follow_me/follow_me.proto)

#include "follow_me.h"

#include <mavsdk/plugins/follow_me/follow_me.h>
#include <cstring>
#include <vector>

// ===== C++ to C Type Conversions =====

static mavsdk_follow_me_result_t
translate_result(mavsdk::FollowMe::Result cpp_result) {
    switch(cpp_result) {
        case mavsdk::FollowMe::Result::Unknown:
            return MAVSDK_FOLLOW_ME_RESULT_UNKNOWN;
        case mavsdk::FollowMe::Result::Success:
            return MAVSDK_FOLLOW_ME_RESULT_SUCCESS;
        case mavsdk::FollowMe::Result::NoSystem:
            return MAVSDK_FOLLOW_ME_RESULT_NO_SYSTEM;
        case mavsdk::FollowMe::Result::ConnectionError:
            return MAVSDK_FOLLOW_ME_RESULT_CONNECTION_ERROR;
        case mavsdk::FollowMe::Result::Busy:
            return MAVSDK_FOLLOW_ME_RESULT_BUSY;
        case mavsdk::FollowMe::Result::CommandDenied:
            return MAVSDK_FOLLOW_ME_RESULT_COMMAND_DENIED;
        case mavsdk::FollowMe::Result::Timeout:
            return MAVSDK_FOLLOW_ME_RESULT_TIMEOUT;
        case mavsdk::FollowMe::Result::NotActive:
            return MAVSDK_FOLLOW_ME_RESULT_NOT_ACTIVE;
        case mavsdk::FollowMe::Result::SetConfigFailed:
            return MAVSDK_FOLLOW_ME_RESULT_SET_CONFIG_FAILED;
    }
}



static mavsdk::FollowMe::Config::FollowAltitudeMode
translate_config_follow_altitude_mode_from_c(mavsdk_follow_me_config_follow_altitude_mode_t c_enum) {
    switch(c_enum) {
        case MAVSDK_FOLLOW_ME_CONFIG_FOLLOW_ALTITUDE_MODE_CONSTANT:
            return mavsdk::FollowMe::Config::FollowAltitudeMode::Constant;
        case MAVSDK_FOLLOW_ME_CONFIG_FOLLOW_ALTITUDE_MODE_TERRAIN:
            return mavsdk::FollowMe::Config::FollowAltitudeMode::Terrain;
        case MAVSDK_FOLLOW_ME_CONFIG_FOLLOW_ALTITUDE_MODE_TARGET_GPS:
            return mavsdk::FollowMe::Config::FollowAltitudeMode::TargetGps;
    }
    return mavsdk::FollowMe::Config::FollowAltitudeMode::Constant;
}


static mavsdk::FollowMe::Config
translate_config_from_c(const mavsdk_follow_me_config_t& c_struct) {
    mavsdk::FollowMe::Config cpp_struct{};
    cpp_struct.follow_height_m = c_struct.follow_height_m;
    cpp_struct.follow_distance_m = c_struct.follow_distance_m;
    cpp_struct.responsiveness = c_struct.responsiveness;
    cpp_struct.altitude_mode = translate_config_follow_altitude_mode_from_c(c_struct.altitude_mode);
    cpp_struct.max_tangential_vel_m_s = c_struct.max_tangential_vel_m_s;
    cpp_struct.follow_angle_deg = c_struct.follow_angle_deg;
    return cpp_struct;
}


static mavsdk_follow_me_config_follow_altitude_mode_t
translate_config_follow_altitude_mode_to_c(mavsdk::FollowMe::Config::FollowAltitudeMode cpp_enum) {
    switch(cpp_enum) {
        case mavsdk::FollowMe::Config::FollowAltitudeMode::Constant:
            return MAVSDK_FOLLOW_ME_CONFIG_FOLLOW_ALTITUDE_MODE_CONSTANT;
        case mavsdk::FollowMe::Config::FollowAltitudeMode::Terrain:
            return MAVSDK_FOLLOW_ME_CONFIG_FOLLOW_ALTITUDE_MODE_TERRAIN;
        case mavsdk::FollowMe::Config::FollowAltitudeMode::TargetGps:
            return MAVSDK_FOLLOW_ME_CONFIG_FOLLOW_ALTITUDE_MODE_TARGET_GPS;
    }
    return MAVSDK_FOLLOW_ME_CONFIG_FOLLOW_ALTITUDE_MODE_CONSTANT;
}

static mavsdk_follow_me_config_t
translate_config_to_c(const mavsdk::FollowMe::Config& cpp_struct) {
    mavsdk_follow_me_config_t c_struct{};
    c_struct.follow_height_m = cpp_struct.follow_height_m;
    c_struct.follow_distance_m = cpp_struct.follow_distance_m;
    c_struct.responsiveness = cpp_struct.responsiveness;
    c_struct.altitude_mode = translate_config_follow_altitude_mode_to_c(cpp_struct.altitude_mode);
    c_struct.max_tangential_vel_m_s = cpp_struct.max_tangential_vel_m_s;
    c_struct.follow_angle_deg = cpp_struct.follow_angle_deg;
    return c_struct;
}

void mavsdk_follow_me_config_destroy(
    mavsdk_follow_me_config_t* target) {
    if (!target) return;
}

void mavsdk_follow_me_config_array_destroy(
    mavsdk_follow_me_config_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_follow_me_config_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::FollowMe::TargetLocation
translate_target_location_from_c(const mavsdk_follow_me_target_location_t& c_struct) {
    mavsdk::FollowMe::TargetLocation cpp_struct{};
    cpp_struct.latitude_deg = c_struct.latitude_deg;
    cpp_struct.longitude_deg = c_struct.longitude_deg;
    cpp_struct.absolute_altitude_m = c_struct.absolute_altitude_m;
    cpp_struct.velocity_x_m_s = c_struct.velocity_x_m_s;
    cpp_struct.velocity_y_m_s = c_struct.velocity_y_m_s;
    cpp_struct.velocity_z_m_s = c_struct.velocity_z_m_s;
    return cpp_struct;
}

static mavsdk_follow_me_target_location_t
translate_target_location_to_c(const mavsdk::FollowMe::TargetLocation& cpp_struct) {
    mavsdk_follow_me_target_location_t c_struct{};
    c_struct.latitude_deg = cpp_struct.latitude_deg;
    c_struct.longitude_deg = cpp_struct.longitude_deg;
    c_struct.absolute_altitude_m = cpp_struct.absolute_altitude_m;
    c_struct.velocity_x_m_s = cpp_struct.velocity_x_m_s;
    c_struct.velocity_y_m_s = cpp_struct.velocity_y_m_s;
    c_struct.velocity_z_m_s = cpp_struct.velocity_z_m_s;
    return c_struct;
}

void mavsdk_follow_me_target_location_destroy(
    mavsdk_follow_me_target_location_t* target) {
    if (!target) return;
}

void mavsdk_follow_me_target_location_array_destroy(
    mavsdk_follow_me_target_location_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_follow_me_target_location_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}



// ===== Primitive Array Destroy Functions =====
void mavsdk_follow_me_float_array_destroy(float** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_follow_me_double_array_destroy(double** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_follow_me_int32t_array_destroy(int32_t** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_follow_me_uint32t_array_destroy(uint32_t** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_follow_me_int64t_array_destroy(int64_t** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_follow_me_uint64t_array_destroy(uint64_t** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_follow_me_bool_array_destroy(bool** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}


void mavsdk_follow_me_string_destroy(char** str) {
    if (!str || !*str) return;
    free(*str);
    *str = nullptr;
}

void mavsdk_follow_me_byte_buffer_destroy(uint8_t** buffer) {
    if (!buffer || !*buffer) return;
    delete[] *buffer;
    *buffer = nullptr;
}

// ===== FollowMe Wrapper =====

struct mavsdk_follow_me_wrapper {
    std::shared_ptr<mavsdk::FollowMe> cpp_plugin;
};

mavsdk_follow_me_t
mavsdk_follow_me_create(mavsdk_system_t system) {
    if (system == nullptr) {
        return nullptr;
    }

    auto wrapper = new mavsdk_follow_me_wrapper();
    auto system_ptr = reinterpret_cast<std::shared_ptr<mavsdk::System>*>(system);
    wrapper->cpp_plugin = std::make_shared<mavsdk::FollowMe>(*system_ptr);

    return reinterpret_cast<mavsdk_follow_me_t>(wrapper);
}

void mavsdk_follow_me_destroy(mavsdk_follow_me_t follow_me) {
    if (follow_me == nullptr) {
        return;
    }

    auto wrapper = reinterpret_cast<mavsdk_follow_me_wrapper*>(follow_me);
    delete wrapper;
}

// ===== Method Implementations =====


// GetConfig sync
void
mavsdk_follow_me_get_config(
    mavsdk_follow_me_t follow_me,
    mavsdk_follow_me_config_t* config_out)
{
    auto wrapper = reinterpret_cast<mavsdk_follow_me_wrapper*>(follow_me);

    auto ret_value = wrapper->cpp_plugin->get_config();

    if (config_out != nullptr) {
        *config_out = translate_config_to_c(ret_value);
    }
}


// SetConfig sync
mavsdk_follow_me_result_t
mavsdk_follow_me_set_config(
    mavsdk_follow_me_t follow_me,
    mavsdk_follow_me_config_t config)
{
    auto wrapper = reinterpret_cast<mavsdk_follow_me_wrapper*>(follow_me);

    auto ret_value = wrapper->cpp_plugin->set_config(        translate_config_from_c(config));

    return translate_result(ret_value);
}


// IsActive sync
void
mavsdk_follow_me_is_active(
    mavsdk_follow_me_t follow_me,
    bool* is_active_out)
{
    auto wrapper = reinterpret_cast<mavsdk_follow_me_wrapper*>(follow_me);

    auto ret_value = wrapper->cpp_plugin->is_active();

    *is_active_out = ret_value;
}


// SetTargetLocation sync
mavsdk_follow_me_result_t
mavsdk_follow_me_set_target_location(
    mavsdk_follow_me_t follow_me,
    mavsdk_follow_me_target_location_t location)
{
    auto wrapper = reinterpret_cast<mavsdk_follow_me_wrapper*>(follow_me);

    auto ret_value = wrapper->cpp_plugin->set_target_location(        translate_target_location_from_c(location));

    return translate_result(ret_value);
}


// GetLastLocation sync
void
mavsdk_follow_me_get_last_location(
    mavsdk_follow_me_t follow_me,
    mavsdk_follow_me_target_location_t* location_out)
{
    auto wrapper = reinterpret_cast<mavsdk_follow_me_wrapper*>(follow_me);

    auto ret_value = wrapper->cpp_plugin->get_last_location();

    if (location_out != nullptr) {
        *location_out = translate_target_location_to_c(ret_value);
    }
}


// Start sync
mavsdk_follow_me_result_t
mavsdk_follow_me_start(
    mavsdk_follow_me_t follow_me)
{
    auto wrapper = reinterpret_cast<mavsdk_follow_me_wrapper*>(follow_me);

    auto ret_value = wrapper->cpp_plugin->start();

    return translate_result(ret_value);
}


// Stop sync
mavsdk_follow_me_result_t
mavsdk_follow_me_stop(
    mavsdk_follow_me_t follow_me)
{
    auto wrapper = reinterpret_cast<mavsdk_follow_me_wrapper*>(follow_me);

    auto ret_value = wrapper->cpp_plugin->stop();

    return translate_result(ret_value);
}

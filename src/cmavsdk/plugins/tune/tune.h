// WARNING: THIS FILE IS AUTOGENERATED! As such, it should not be edited.
// Edits need to be made to the proto files
// (see https://github.com/mavlink/MAVSDK-Proto/blob/main/protos/tune/tune.proto)

#ifndef CMAVSDK_TUNE_H
#define CMAVSDK_TUNE_H

#include <stddef.h>
#include <stdint.h>
#include <stdbool.h>
#include "cmavsdk/mavsdk_export.h"

#ifdef __cplusplus
extern "C" {
#endif

/**
 * @brief Enable creating and sending a tune to be played on the system.
 */

// ===== Forward Declarations =====
typedef void* mavsdk_system_t;

// ===== Opaque Handles =====
typedef void* mavsdk_tune_t;

// ===== Enums =====
/**
 * @brief An element of the tune
 */
typedef enum {
    /**  After this element, start playing legato. */
    MAVSDK_TUNE_SONG_ELEMENT_STYLE_LEGATO = 0,
    /**  After this element, start playing normal. */
    MAVSDK_TUNE_SONG_ELEMENT_STYLE_NORMAL = 1,
    /**  After this element, start playing staccato. */
    MAVSDK_TUNE_SONG_ELEMENT_STYLE_STACCATO = 2,
    /**  After this element, set the note duration to 1. */
    MAVSDK_TUNE_SONG_ELEMENT_DURATION_1 = 3,
    /**  After this element, set the note duration to 2. */
    MAVSDK_TUNE_SONG_ELEMENT_DURATION_2 = 4,
    /**  After this element, set the note duration to 4. */
    MAVSDK_TUNE_SONG_ELEMENT_DURATION_4 = 5,
    /**  After this element, set the note duration to 8. */
    MAVSDK_TUNE_SONG_ELEMENT_DURATION_8 = 6,
    /**  After this element, set the note duration to 16. */
    MAVSDK_TUNE_SONG_ELEMENT_DURATION_16 = 7,
    /**  After this element, set the note duration to 32. */
    MAVSDK_TUNE_SONG_ELEMENT_DURATION_32 = 8,
    /**  Play note A. */
    MAVSDK_TUNE_SONG_ELEMENT_NOTE_A = 9,
    /**  Play note B. */
    MAVSDK_TUNE_SONG_ELEMENT_NOTE_B = 10,
    /**  Play note C. */
    MAVSDK_TUNE_SONG_ELEMENT_NOTE_C = 11,
    /**  Play note D. */
    MAVSDK_TUNE_SONG_ELEMENT_NOTE_D = 12,
    /**  Play note E. */
    MAVSDK_TUNE_SONG_ELEMENT_NOTE_E = 13,
    /**  Play note F. */
    MAVSDK_TUNE_SONG_ELEMENT_NOTE_F = 14,
    /**  Play note G. */
    MAVSDK_TUNE_SONG_ELEMENT_NOTE_G = 15,
    /**  Play a rest. */
    MAVSDK_TUNE_SONG_ELEMENT_NOTE_PAUSE = 16,
    /**  After this element, sharp the note (half a step up). */
    MAVSDK_TUNE_SONG_ELEMENT_SHARP = 17,
    /**  After this element, flat the note (half a step down). */
    MAVSDK_TUNE_SONG_ELEMENT_FLAT = 18,
    /**  After this element, shift the note 1 octave up. */
    MAVSDK_TUNE_SONG_ELEMENT_OCTAVE_UP = 19,
    /**  After this element, shift the note 1 octave down. */
    MAVSDK_TUNE_SONG_ELEMENT_OCTAVE_DOWN = 20,
} mavsdk_tune_song_element_t;


// ===== Structs =====
/**
 * @brief Tune description, containing song elements and tempo.
 *
 * @note This struct may contain dynamically allocated memory. Always call
 *       mavsdk_tune_tune_description_destroy() when done to avoid memory leaks.
 */
typedef struct CMAVSDK_EXPORT {
    /**  The list of song elements (notes, pauses, ...) to be played */
    mavsdk_tune_song_element_t* song_elements;
    size_t song_elements_size;
    /**  The tempo of the song (range: 32 - 255) */
    int32_t tempo;
} mavsdk_tune_tune_description_t;

/**
 * @brief Destroy a tune_description struct.
 *
 * Frees all memory allocated by MAVSDK for this struct, including any
 * dynamically allocated arrays or strings. Must be called to avoid memory leaks.
 * Always call this function when done with the struct, even if it currently
 * contains no dynamic allocations.
 *
 * @param target Pointer to the struct to destroy. Can be NULL (no-op).
 */
CMAVSDK_EXPORT void mavsdk_tune_tune_description_destroy(
    mavsdk_tune_tune_description_t* target);

/**
 * @brief Destroy an array of tune_description structs.
 *
 * Frees all memory allocated for the array and its elements, including any
 * nested dynamic allocations. Must be called to avoid memory leaks.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 * @param size Number of elements in the array.
 */
CMAVSDK_EXPORT void mavsdk_tune_tune_description_array_destroy(
    mavsdk_tune_tune_description_t** array,
    size_t size);

/**
 * @brief Possible results returned for tune requests.
 */
typedef enum {
    /**  Unknown result. */
    MAVSDK_TUNE_RESULT_UNKNOWN = 0,
    /**  Request succeeded. */
    MAVSDK_TUNE_RESULT_SUCCESS = 1,
    /**  Invalid tempo (range: 32 - 255). */
    MAVSDK_TUNE_RESULT_INVALID_TEMPO = 2,
    /**  Invalid tune: encoded string must be at most 247 chars. */
    MAVSDK_TUNE_RESULT_TUNE_TOO_LONG = 3,
    /**  Failed to send the request. */
    MAVSDK_TUNE_RESULT_ERROR = 4,
    /**  No system connected. */
    MAVSDK_TUNE_RESULT_NO_SYSTEM = 5,
} mavsdk_tune_result_t;



// ===== Primitive Array Destroy Functions =====
/**
 * @brief Destroy an array of float.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_tune_float_array_destroy(float** array);
/**
 * @brief Destroy an array of double.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_tune_double_array_destroy(double** array);
/**
 * @brief Destroy an array of int32_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_tune_int32t_array_destroy(int32_t** array);
/**
 * @brief Destroy an array of uint32_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_tune_uint32t_array_destroy(uint32_t** array);
/**
 * @brief Destroy an array of int64_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_tune_int64t_array_destroy(int64_t** array);
/**
 * @brief Destroy an array of uint64_t.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_tune_uint64t_array_destroy(uint64_t** array);
/**
 * @brief Destroy an array of bool.
 *
 * Frees the memory allocated for the array.
 *
 * @param array Pointer to the array pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_tune_bool_array_destroy(bool** array);

/**
 * @brief Destroy a string (char*).
 *
 * Frees the memory allocated for the string.
 *
 * @param str Pointer to the string pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_tune_string_destroy(char** str);

/**
 * @brief Destroy a byte buffer (uint8_t*).
 *
 * Frees the memory allocated for the byte buffer.
 *
 * @param buffer Pointer to the buffer pointer. Will be set to NULL after freeing.
 */
CMAVSDK_EXPORT void mavsdk_tune_byte_buffer_destroy(uint8_t** buffer);

// ===== Callback Typedefs =====
typedef void (*mavsdk_tune_play_tune_callback_t)(const mavsdk_tune_result_t result, void* user_data);

// ===== Tune Creation/Destruction =====
CMAVSDK_EXPORT mavsdk_tune_t mavsdk_tune_create(mavsdk_system_t system);
CMAVSDK_EXPORT void mavsdk_tune_destroy(mavsdk_tune_t tune);

// ===== Methods =====

/**
 * @brief Send a tune to be played by the system.
 *
 * @param tune The tune instance.
* @param tune_description  The tune to be played
 * 
 * @param callback Function to call when new data is available.
 * @param user_data User data to pass to the callback.
 */
CMAVSDK_EXPORT void mavsdk_tune_play_tune_async(
    mavsdk_tune_t tune,
    mavsdk_tune_tune_description_t tune_description,
    mavsdk_tune_play_tune_callback_t callback,
    void* user_data);


/**
 * @brief Get the current play tune (blocking).
 *
 * This function blocks until a value is available.
 *
 * @param telemetry The telemetry instance.
 * @param play_tune_out Pointer to store the result.
 */
CMAVSDK_EXPORT
mavsdk_tune_result_t
mavsdk_tune_play_tune(
    mavsdk_tune_t tune,
    mavsdk_tune_tune_description_t tune_description);


#ifdef __cplusplus
}
#endif

#endif // CMAVSDK_TUNE_H
// WARNING: THIS FILE IS AUTOGENERATED! As such, it should not be edited.
// Edits need to be made to the proto files
// (see https://github.com/mavlink/MAVSDK-Proto/blob/main/protos/mocap/mocap.proto)

#include "mocap.h"

#include <mavsdk/plugins/mocap/mocap.h>
#include <cstring>
#include <vector>

// ===== C++ to C Type Conversions =====

static mavsdk_mocap_result_t
translate_result(mavsdk::Mocap::Result cpp_result) {
    switch(cpp_result) {
        case mavsdk::Mocap::Result::Unknown:
            return MAVSDK_MOCAP_RESULT_UNKNOWN;
        case mavsdk::Mocap::Result::Success:
            return MAVSDK_MOCAP_RESULT_SUCCESS;
        case mavsdk::Mocap::Result::NoSystem:
            return MAVSDK_MOCAP_RESULT_NO_SYSTEM;
        case mavsdk::Mocap::Result::ConnectionError:
            return MAVSDK_MOCAP_RESULT_CONNECTION_ERROR;
        case mavsdk::Mocap::Result::InvalidRequestData:
            return MAVSDK_MOCAP_RESULT_INVALID_REQUEST_DATA;
        case mavsdk::Mocap::Result::Unsupported:
            return MAVSDK_MOCAP_RESULT_UNSUPPORTED;
    }
}



static mavsdk::Mocap::PositionBody
translate_position_body_from_c(const mavsdk_mocap_position_body_t& c_struct) {
    mavsdk::Mocap::PositionBody cpp_struct{};
    cpp_struct.x_m = c_struct.x_m;
    cpp_struct.y_m = c_struct.y_m;
    cpp_struct.z_m = c_struct.z_m;
    return cpp_struct;
}

static mavsdk_mocap_position_body_t
translate_position_body_to_c(const mavsdk::Mocap::PositionBody& cpp_struct) {
    mavsdk_mocap_position_body_t c_struct{};
    c_struct.x_m = cpp_struct.x_m;
    c_struct.y_m = cpp_struct.y_m;
    c_struct.z_m = cpp_struct.z_m;
    return c_struct;
}

void mavsdk_mocap_position_body_destroy(
    mavsdk_mocap_position_body_t* target) {
    if (!target) return;
}

void mavsdk_mocap_position_body_array_destroy(
    mavsdk_mocap_position_body_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_position_body_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::Mocap::AngleBody
translate_angle_body_from_c(const mavsdk_mocap_angle_body_t& c_struct) {
    mavsdk::Mocap::AngleBody cpp_struct{};
    cpp_struct.roll_rad = c_struct.roll_rad;
    cpp_struct.pitch_rad = c_struct.pitch_rad;
    cpp_struct.yaw_rad = c_struct.yaw_rad;
    return cpp_struct;
}

static mavsdk_mocap_angle_body_t
translate_angle_body_to_c(const mavsdk::Mocap::AngleBody& cpp_struct) {
    mavsdk_mocap_angle_body_t c_struct{};
    c_struct.roll_rad = cpp_struct.roll_rad;
    c_struct.pitch_rad = cpp_struct.pitch_rad;
    c_struct.yaw_rad = cpp_struct.yaw_rad;
    return c_struct;
}

void mavsdk_mocap_angle_body_destroy(
    mavsdk_mocap_angle_body_t* target) {
    if (!target) return;
}

void mavsdk_mocap_angle_body_array_destroy(
    mavsdk_mocap_angle_body_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_angle_body_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::Mocap::SpeedBody
translate_speed_body_from_c(const mavsdk_mocap_speed_body_t& c_struct) {
    mavsdk::Mocap::SpeedBody cpp_struct{};
    cpp_struct.x_m_s = c_struct.x_m_s;
    cpp_struct.y_m_s = c_struct.y_m_s;
    cpp_struct.z_m_s = c_struct.z_m_s;
    return cpp_struct;
}

static mavsdk_mocap_speed_body_t
translate_speed_body_to_c(const mavsdk::Mocap::SpeedBody& cpp_struct) {
    mavsdk_mocap_speed_body_t c_struct{};
    c_struct.x_m_s = cpp_struct.x_m_s;
    c_struct.y_m_s = cpp_struct.y_m_s;
    c_struct.z_m_s = cpp_struct.z_m_s;
    return c_struct;
}

void mavsdk_mocap_speed_body_destroy(
    mavsdk_mocap_speed_body_t* target) {
    if (!target) return;
}

void mavsdk_mocap_speed_body_array_destroy(
    mavsdk_mocap_speed_body_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_speed_body_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::Mocap::SpeedNed
translate_speed_ned_from_c(const mavsdk_mocap_speed_ned_t& c_struct) {
    mavsdk::Mocap::SpeedNed cpp_struct{};
    cpp_struct.north_m_s = c_struct.north_m_s;
    cpp_struct.east_m_s = c_struct.east_m_s;
    cpp_struct.down_m_s = c_struct.down_m_s;
    return cpp_struct;
}

static mavsdk_mocap_speed_ned_t
translate_speed_ned_to_c(const mavsdk::Mocap::SpeedNed& cpp_struct) {
    mavsdk_mocap_speed_ned_t c_struct{};
    c_struct.north_m_s = cpp_struct.north_m_s;
    c_struct.east_m_s = cpp_struct.east_m_s;
    c_struct.down_m_s = cpp_struct.down_m_s;
    return c_struct;
}

void mavsdk_mocap_speed_ned_destroy(
    mavsdk_mocap_speed_ned_t* target) {
    if (!target) return;
}

void mavsdk_mocap_speed_ned_array_destroy(
    mavsdk_mocap_speed_ned_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_speed_ned_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::Mocap::AngularVelocityBody
translate_angular_velocity_body_from_c(const mavsdk_mocap_angular_velocity_body_t& c_struct) {
    mavsdk::Mocap::AngularVelocityBody cpp_struct{};
    cpp_struct.roll_rad_s = c_struct.roll_rad_s;
    cpp_struct.pitch_rad_s = c_struct.pitch_rad_s;
    cpp_struct.yaw_rad_s = c_struct.yaw_rad_s;
    return cpp_struct;
}

static mavsdk_mocap_angular_velocity_body_t
translate_angular_velocity_body_to_c(const mavsdk::Mocap::AngularVelocityBody& cpp_struct) {
    mavsdk_mocap_angular_velocity_body_t c_struct{};
    c_struct.roll_rad_s = cpp_struct.roll_rad_s;
    c_struct.pitch_rad_s = cpp_struct.pitch_rad_s;
    c_struct.yaw_rad_s = cpp_struct.yaw_rad_s;
    return c_struct;
}

void mavsdk_mocap_angular_velocity_body_destroy(
    mavsdk_mocap_angular_velocity_body_t* target) {
    if (!target) return;
}

void mavsdk_mocap_angular_velocity_body_array_destroy(
    mavsdk_mocap_angular_velocity_body_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_angular_velocity_body_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::Mocap::Covariance
translate_covariance_from_c(const mavsdk_mocap_covariance_t& c_struct) {
    mavsdk::Mocap::Covariance cpp_struct{};
    cpp_struct.covariance_matrix.assign(
        c_struct.covariance_matrix,
        c_struct.covariance_matrix + c_struct.covariance_matrix_size);
    return cpp_struct;
}

static mavsdk_mocap_covariance_t
translate_covariance_to_c(const mavsdk::Mocap::Covariance& cpp_struct) {
    mavsdk_mocap_covariance_t c_struct{};
    c_struct.covariance_matrix_size = cpp_struct.covariance_matrix.size();
    c_struct.covariance_matrix = new float[c_struct.covariance_matrix_size];
    std::copy(cpp_struct.covariance_matrix.begin(), cpp_struct.covariance_matrix.end(), c_struct.covariance_matrix);
    return c_struct;
}

void mavsdk_mocap_covariance_destroy(
    mavsdk_mocap_covariance_t* target) {
    if (!target) return;
    if (target->covariance_matrix) {
        delete[] target->covariance_matrix;
        target->covariance_matrix = nullptr;
        target->covariance_matrix_size = 0;
    }
}

void mavsdk_mocap_covariance_array_destroy(
    mavsdk_mocap_covariance_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_covariance_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::Mocap::Quaternion
translate_quaternion_from_c(const mavsdk_mocap_quaternion_t& c_struct) {
    mavsdk::Mocap::Quaternion cpp_struct{};
    cpp_struct.w = c_struct.w;
    cpp_struct.x = c_struct.x;
    cpp_struct.y = c_struct.y;
    cpp_struct.z = c_struct.z;
    return cpp_struct;
}

static mavsdk_mocap_quaternion_t
translate_quaternion_to_c(const mavsdk::Mocap::Quaternion& cpp_struct) {
    mavsdk_mocap_quaternion_t c_struct{};
    c_struct.w = cpp_struct.w;
    c_struct.x = cpp_struct.x;
    c_struct.y = cpp_struct.y;
    c_struct.z = cpp_struct.z;
    return c_struct;
}

void mavsdk_mocap_quaternion_destroy(
    mavsdk_mocap_quaternion_t* target) {
    if (!target) return;
}

void mavsdk_mocap_quaternion_array_destroy(
    mavsdk_mocap_quaternion_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_quaternion_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::Mocap::VisionPositionEstimate
translate_vision_position_estimate_from_c(const mavsdk_mocap_vision_position_estimate_t& c_struct) {
    mavsdk::Mocap::VisionPositionEstimate cpp_struct{};
    cpp_struct.time_usec = c_struct.time_usec;
    cpp_struct.position_body = translate_position_body_from_c(c_struct.position_body);
    cpp_struct.angle_body = translate_angle_body_from_c(c_struct.angle_body);
    cpp_struct.pose_covariance = translate_covariance_from_c(c_struct.pose_covariance);
    return cpp_struct;
}

static mavsdk_mocap_vision_position_estimate_t
translate_vision_position_estimate_to_c(const mavsdk::Mocap::VisionPositionEstimate& cpp_struct) {
    mavsdk_mocap_vision_position_estimate_t c_struct{};
    c_struct.time_usec = cpp_struct.time_usec;
    c_struct.position_body = translate_position_body_to_c(cpp_struct.position_body);
    c_struct.angle_body = translate_angle_body_to_c(cpp_struct.angle_body);
    c_struct.pose_covariance = translate_covariance_to_c(cpp_struct.pose_covariance);
    return c_struct;
}

void mavsdk_mocap_vision_position_estimate_destroy(
    mavsdk_mocap_vision_position_estimate_t* target) {
    if (!target) return;
}

void mavsdk_mocap_vision_position_estimate_array_destroy(
    mavsdk_mocap_vision_position_estimate_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_vision_position_estimate_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::Mocap::VisionSpeedEstimate
translate_vision_speed_estimate_from_c(const mavsdk_mocap_vision_speed_estimate_t& c_struct) {
    mavsdk::Mocap::VisionSpeedEstimate cpp_struct{};
    cpp_struct.time_usec = c_struct.time_usec;
    cpp_struct.speed_ned = translate_speed_ned_from_c(c_struct.speed_ned);
    cpp_struct.speed_covariance = translate_covariance_from_c(c_struct.speed_covariance);
    return cpp_struct;
}

static mavsdk_mocap_vision_speed_estimate_t
translate_vision_speed_estimate_to_c(const mavsdk::Mocap::VisionSpeedEstimate& cpp_struct) {
    mavsdk_mocap_vision_speed_estimate_t c_struct{};
    c_struct.time_usec = cpp_struct.time_usec;
    c_struct.speed_ned = translate_speed_ned_to_c(cpp_struct.speed_ned);
    c_struct.speed_covariance = translate_covariance_to_c(cpp_struct.speed_covariance);
    return c_struct;
}

void mavsdk_mocap_vision_speed_estimate_destroy(
    mavsdk_mocap_vision_speed_estimate_t* target) {
    if (!target) return;
}

void mavsdk_mocap_vision_speed_estimate_array_destroy(
    mavsdk_mocap_vision_speed_estimate_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_vision_speed_estimate_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::Mocap::AttitudePositionMocap
translate_attitude_position_mocap_from_c(const mavsdk_mocap_attitude_position_mocap_t& c_struct) {
    mavsdk::Mocap::AttitudePositionMocap cpp_struct{};
    cpp_struct.time_usec = c_struct.time_usec;
    cpp_struct.q = translate_quaternion_from_c(c_struct.q);
    cpp_struct.position_body = translate_position_body_from_c(c_struct.position_body);
    cpp_struct.pose_covariance = translate_covariance_from_c(c_struct.pose_covariance);
    return cpp_struct;
}

static mavsdk_mocap_attitude_position_mocap_t
translate_attitude_position_mocap_to_c(const mavsdk::Mocap::AttitudePositionMocap& cpp_struct) {
    mavsdk_mocap_attitude_position_mocap_t c_struct{};
    c_struct.time_usec = cpp_struct.time_usec;
    c_struct.q = translate_quaternion_to_c(cpp_struct.q);
    c_struct.position_body = translate_position_body_to_c(cpp_struct.position_body);
    c_struct.pose_covariance = translate_covariance_to_c(cpp_struct.pose_covariance);
    return c_struct;
}

void mavsdk_mocap_attitude_position_mocap_destroy(
    mavsdk_mocap_attitude_position_mocap_t* target) {
    if (!target) return;
}

void mavsdk_mocap_attitude_position_mocap_array_destroy(
    mavsdk_mocap_attitude_position_mocap_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_attitude_position_mocap_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}


static mavsdk::Mocap::Odometry::MavFrame
translate_odometry_mav_frame_from_c(mavsdk_mocap_odometry_mav_frame_t c_enum) {
    switch(c_enum) {
        case MAVSDK_MOCAP_ODOMETRY_MAV_FRAME_MOCAP_NED:
            return mavsdk::Mocap::Odometry::MavFrame::MocapNed;
        case MAVSDK_MOCAP_ODOMETRY_MAV_FRAME_LOCAL_FRD:
            return mavsdk::Mocap::Odometry::MavFrame::LocalFrd;
    }
    return mavsdk::Mocap::Odometry::MavFrame::MocapNed;
}


static mavsdk::Mocap::Odometry
translate_odometry_from_c(const mavsdk_mocap_odometry_t& c_struct) {
    mavsdk::Mocap::Odometry cpp_struct{};
    cpp_struct.time_usec = c_struct.time_usec;
    cpp_struct.frame_id = translate_odometry_mav_frame_from_c(c_struct.frame_id);
    cpp_struct.position_body = translate_position_body_from_c(c_struct.position_body);
    cpp_struct.q = translate_quaternion_from_c(c_struct.q);
    cpp_struct.speed_body = translate_speed_body_from_c(c_struct.speed_body);
    cpp_struct.angular_velocity_body = translate_angular_velocity_body_from_c(c_struct.angular_velocity_body);
    cpp_struct.pose_covariance = translate_covariance_from_c(c_struct.pose_covariance);
    cpp_struct.velocity_covariance = translate_covariance_from_c(c_struct.velocity_covariance);
    return cpp_struct;
}


static mavsdk_mocap_odometry_mav_frame_t
translate_odometry_mav_frame_to_c(mavsdk::Mocap::Odometry::MavFrame cpp_enum) {
    switch(cpp_enum) {
        case mavsdk::Mocap::Odometry::MavFrame::MocapNed:
            return MAVSDK_MOCAP_ODOMETRY_MAV_FRAME_MOCAP_NED;
        case mavsdk::Mocap::Odometry::MavFrame::LocalFrd:
            return MAVSDK_MOCAP_ODOMETRY_MAV_FRAME_LOCAL_FRD;
    }
    return MAVSDK_MOCAP_ODOMETRY_MAV_FRAME_MOCAP_NED;
}

static mavsdk_mocap_odometry_t
translate_odometry_to_c(const mavsdk::Mocap::Odometry& cpp_struct) {
    mavsdk_mocap_odometry_t c_struct{};
    c_struct.time_usec = cpp_struct.time_usec;
    c_struct.frame_id = translate_odometry_mav_frame_to_c(cpp_struct.frame_id);
    c_struct.position_body = translate_position_body_to_c(cpp_struct.position_body);
    c_struct.q = translate_quaternion_to_c(cpp_struct.q);
    c_struct.speed_body = translate_speed_body_to_c(cpp_struct.speed_body);
    c_struct.angular_velocity_body = translate_angular_velocity_body_to_c(cpp_struct.angular_velocity_body);
    c_struct.pose_covariance = translate_covariance_to_c(cpp_struct.pose_covariance);
    c_struct.velocity_covariance = translate_covariance_to_c(cpp_struct.velocity_covariance);
    return c_struct;
}

void mavsdk_mocap_odometry_destroy(
    mavsdk_mocap_odometry_t* target) {
    if (!target) return;
}

void mavsdk_mocap_odometry_array_destroy(
    mavsdk_mocap_odometry_t** array,
    size_t size) {
    if (!array || !*array) return;

    for (size_t i = 0; i < size; i++) {
        mavsdk_mocap_odometry_destroy(&(*array)[i]);
    }

    delete[] *array;
    *array = nullptr;
}



// ===== Primitive Array Destroy Functions =====
void mavsdk_mocap_float_array_destroy(float** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_mocap_double_array_destroy(double** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_mocap_int32t_array_destroy(int32_t** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_mocap_uint32t_array_destroy(uint32_t** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_mocap_int64t_array_destroy(int64_t** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_mocap_uint64t_array_destroy(uint64_t** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}

void mavsdk_mocap_bool_array_destroy(bool** array) {
    if (!array || !*array) return;
    delete[] *array;
    *array = nullptr;
}


void mavsdk_mocap_string_destroy(char** str) {
    if (!str || !*str) return;
    free(*str);
    *str = nullptr;
}

void mavsdk_mocap_byte_buffer_destroy(uint8_t** buffer) {
    if (!buffer || !*buffer) return;
    delete[] *buffer;
    *buffer = nullptr;
}

// ===== Mocap Wrapper =====

struct mavsdk_mocap_wrapper {
    std::shared_ptr<mavsdk::Mocap> cpp_plugin;
};

mavsdk_mocap_t
mavsdk_mocap_create(mavsdk_system_t system) {
    if (system == nullptr) {
        return nullptr;
    }

    auto wrapper = new mavsdk_mocap_wrapper();
    auto system_ptr = static_cast<std::shared_ptr<mavsdk::System>*>(system);
    wrapper->cpp_plugin = std::make_shared<mavsdk::Mocap>(*system_ptr);

    return wrapper;
}

void mavsdk_mocap_destroy(mavsdk_mocap_t mocap) {
    if (mocap == nullptr) {
        return;
    }

    auto wrapper = static_cast<mavsdk_mocap_wrapper*>(mocap);
    delete wrapper;
}

// ===== Method Implementations =====


// SetVisionPositionEstimate sync
mavsdk_mocap_result_t
mavsdk_mocap_set_vision_position_estimate(
    mavsdk_mocap_t mocap,
    mavsdk_mocap_vision_position_estimate_t vision_position_estimate)
{
    auto wrapper = static_cast<mavsdk_mocap_wrapper*>(mocap);

    auto ret_value = wrapper->cpp_plugin->set_vision_position_estimate(        translate_vision_position_estimate_from_c(vision_position_estimate));

    return translate_result(ret_value);
}


// SetVisionSpeedEstimate sync
mavsdk_mocap_result_t
mavsdk_mocap_set_vision_speed_estimate(
    mavsdk_mocap_t mocap,
    mavsdk_mocap_vision_speed_estimate_t vision_speed_estimate)
{
    auto wrapper = static_cast<mavsdk_mocap_wrapper*>(mocap);

    auto ret_value = wrapper->cpp_plugin->set_vision_speed_estimate(        translate_vision_speed_estimate_from_c(vision_speed_estimate));

    return translate_result(ret_value);
}


// SetAttitudePositionMocap sync
mavsdk_mocap_result_t
mavsdk_mocap_set_attitude_position_mocap(
    mavsdk_mocap_t mocap,
    mavsdk_mocap_attitude_position_mocap_t attitude_position_mocap)
{
    auto wrapper = static_cast<mavsdk_mocap_wrapper*>(mocap);

    auto ret_value = wrapper->cpp_plugin->set_attitude_position_mocap(        translate_attitude_position_mocap_from_c(attitude_position_mocap));

    return translate_result(ret_value);
}


// SetOdometry sync
mavsdk_mocap_result_t
mavsdk_mocap_set_odometry(
    mavsdk_mocap_t mocap,
    mavsdk_mocap_odometry_t odometry)
{
    auto wrapper = static_cast<mavsdk_mocap_wrapper*>(mocap);

    auto ret_value = wrapper->cpp_plugin->set_odometry(        translate_odometry_from_c(odometry));

    return translate_result(ret_value);
}
